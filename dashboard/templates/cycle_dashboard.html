{% extends "layout.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h3><a href="/" class="text-decoration-none text-dark">ğŸ </a> ì‚¬ì´í´: 251112</h3>
    <span class="badge bg-warning text-dark fs-6">Step 4: PM êµ¬ì¡° ì»¨íŒ ëŒ€ê¸°ì¤‘</span>
</div>

<div class="row">
    <!-- 14-Step Workflow -->
    <div class="col-md-5">
        <div class="card">
            <div class="card-header">
                14-Step Workflow
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item d-flex justify-content-between align-items-center"><span><i class="ri-check-line text-success"></i> 1. ìë£Œ ì¡°ì‚¬ (AI)</span> <span class="badge bg-success">ì™„ë£Œ</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center"><span><i class="ri-check-line text-success"></i> 2. ì£¼ì œ/í¬ë§· ì„ íƒ (PM)</span> <span class="badge bg-success">ì™„ë£Œ</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center"><span><i class="ri-check-line text-success"></i> 3. êµ¬ì¡° ì„¤ê³„ (AI)</span> <span class="badge bg-success">ì™„ë£Œ</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span><i class="ri-user-search-line text-warning"></i> 4. êµ¬ì¡° ì»¨íŒ (PM)</span>
                    <div>
                        <button class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#modal-reviewer">ê²€í† í•˜ê¸°</button>
                    </div>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-loader-4-line"></i> 5. í’€ ì½˜í…ì¸  ì‘ì„± (AI)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-loader-4-line"></i> 6. ê¸°ì´ˆ ê²€ìˆ˜ (AI)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-loader-4-line"></i> 7. ë¦¬ì¹˜ ì½˜í…ì¸  ë Œë”ë§</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-user-search-line"></i> 8. ì›ë³¸ ìµœì¢… ê²€ìˆ˜ (PM)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-loader-4-line"></i> 9. SNS ë³€í˜• (AI)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content_between align-items-center text-muted"><span><i class="ri-loader-4-line"></i> 10. SNS ê¸°ì´ˆ ê²€ìˆ˜ (AI)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-user-search-line"></i> 11. SNS ìµœì¢… ê²€ìˆ˜ (PM)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-loader-4-line"></i> 12. ì „ì²´ ë²ˆì—­ (AI)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-loader-4-line"></i> 13. ë²ˆì—­ ê²€ìˆ˜/êµì • (AI)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
                <li class="list-group-item d-flex justify-content-between align-items-center text-muted"><span><i class="ri-send-plane-line"></i> 14. ìµœì¢… ë°°í¬ (PM)</span> <span class="badge bg-light text-dark">ëŒ€ê¸°</span></li>
            </ul>
        </div>
    </div>

    <!-- Log Viewer -->
    <div class="col-md-7">
        <div class="card">
            <div class="card-header">
                ë¡œê·¸ ë·°ì–´
            </div>
            <div class="card-body bg-dark text-light font-monospace" style="height: 600px; overflow-y: scroll;">
                <pre>[INFO] Cycle 251112-Step3-Outline started.
[INFO] Calling Claude API for outline generation.
[SUCCESS] Outline generated successfully.
[INFO] Saved outline to content-output/251112/step2-outline/step2-outline.md
[INFO] Updating manifest.json status to STEP_4_PENDING_APPROVAL.
                </pre>
            </div>
        </div>
    </div>
</div>


<!-- Modal 2: ì‚°ì¶œë¬¼ ë·°ì–´ & ê²€ìˆ˜ -->
<div class="modal modal-xl fade" id="modal-reviewer" tabindex="-1" aria-labelledby="reviewerModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="reviewerModalLabel">ì‚°ì¶œë¬¼ ê²€ìˆ˜ (Step 4: êµ¬ì¡° ì»¨íŒ)</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <ul class="nav nav-tabs" id="reviewerTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="markdown-tab" data-bs-toggle="tab" data-bs-target="#markdown-pane" type="button" role="tab">Markdown (ìˆ˜ì •)</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="preview-tab" data-bs-toggle="tab" data-bs-target="#preview-pane" type="button" role="tab">HTML í”„ë¦¬ë·°</button>
                    </li>
                </ul>
                <div class="tab-content" id="reviewerTabContent">
                    <div class="tab-pane fade show active" id="markdown-pane" role="tabpanel">
                        <!-- EasyMDE ì—ë””í„°ê°€ ì—¬ê¸°ì— ë¡œë“œë  ê²ƒì…ë‹ˆë‹¤. -->
                        <textarea id="easymde-editor"></textarea>
                    </div>
                    <div class="tab-pane fade" id="preview-pane" role="tabpanel">
                        <iframe srcdoc="<p>HTML í”„ë¦¬ë·°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>" style="width: 100%; height: 500px; border: 1px solid #ccc;"></iframe>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#modal-assets"><i class="ri-image-add-line"></i> ì—ì…‹ ì‚½ì…</button>
                <button type="button" class="btn btn-light"><i class="ri-code-box-line"></i> ì»´í¬ë„ŒíŠ¸ ì‚½ì…</button>
                <div class="ms-auto">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                    <button type="button" class="btn btn-primary">ì €ì¥</button>
                    <button type="button" class="btn btn-success">ìŠ¹ì¸</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 4: ì—ì…‹ ì‚½ì… -->
<div class="modal fade" id="modal-assets" tabindex="-1" aria-labelledby="assetsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="assetsModalLabel">ì—ì…‹ ì‚½ì…</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>assets/emoji/ í´ë”ì˜ ì´ë¯¸ì§€ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
                <!-- ì´ë¯¸ì§€ ëª©ë¡ -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-target="#modal-reviewer" data-bs-toggle="modal">ëŒì•„ê°€ê¸°</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/easymde.min.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize EasyMDE when the modal is shown
        const reviewerModal = document.getElementById('modal-reviewer');
        let easyMDE;

        reviewerModal.addEventListener('shown.bs.modal', function () {
            if (!easyMDE) {
                easyMDE = new EasyMDE({
                    element: document.getElementById('easymde-editor'),
                    spellChecker: false,
                    placeholder: "ì½˜í…ì¸ ë¥¼ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”...",
                    initialValue: "### Step 4: êµ¬ì¡° ì»¨íŒ\n\n- í•­ëª© 1\n- í•­ëª© 2\n- í•­ëª© 3"
                });
            }
        });
    });
</script>
{% endblock %}
